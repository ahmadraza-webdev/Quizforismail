<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ismail's Quizzes</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #fdf6ee;
    --card: #ffffff;
    --border: #e8ddd0;
    --ink: #1a1410;
    --muted: #9c8878;
    --accent: #ff6b35;
    --accent2: #4ecdc4;
    --correct: #2ec4b6;
    --wrong: #ff6b6b;
    --radius: 18px;
    --shadow: 0 4px 24px #1a141015;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Nunito', sans-serif;
    background: var(--bg);
    color: var(--ink);
    min-height: 100vh;
  }
  body::before {
    content: '';
    position: fixed; inset: 0;
    background:
      radial-gradient(ellipse 600px 400px at 10% 20%, #ff6b3515 0%, transparent 70%),
      radial-gradient(ellipse 500px 500px at 90% 80%, #4ecdc415 0%, transparent 70%);
    pointer-events: none; z-index: 0;
  }
  main { position: relative; z-index: 1; max-width: 700px; margin: 0 auto; padding: 40px 20px 80px; }

  /* HEADER */
  .site-header { text-align: center; margin-bottom: 48px; animation: popIn 0.5s cubic-bezier(0.34,1.56,0.64,1); }
  .header-emoji { font-size: 3.5rem; display: block; margin-bottom: 8px; }
  .site-title { font-size: 2.6rem; font-weight: 900; letter-spacing: -1px; line-height: 1.1; }
  .site-title .name { color: var(--accent); }
  .site-subtitle { margin-top: 8px; color: var(--muted); font-size: 1rem; font-weight: 600; }

  @keyframes popIn {
    from { opacity: 0; transform: scale(0.85) translateY(-10px); }
    to   { opacity: 1; transform: scale(1) translateY(0); }
  }
  @keyframes fadeUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }

  /* SCREENS */
  .screen { display: none; }
  .screen.active { display: block; animation: fadeUp 0.35s ease; }

  /* LOADING */
  .loading-state { text-align: center; padding: 60px 20px; color: var(--muted); font-size: 1rem; font-weight: 600; }
  .spinner {
    width: 40px; height: 40px;
    border: 4px solid var(--border); border-top-color: var(--accent);
    border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 16px;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* QUIZ GRID */
  .section-label {
    font-family: 'DM Mono', monospace; font-size: 0.7rem;
    letter-spacing: 2px; text-transform: uppercase;
    color: var(--muted); margin-bottom: 14px; padding-left: 4px;
  }
  .quiz-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 40px; }
  @media (max-width: 480px) { .quiz-grid { grid-template-columns: 1fr; } }

  .quiz-card {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: var(--radius);
    padding: 22px 20px;
    cursor: pointer;
    transition: transform 0.2s cubic-bezier(0.34,1.56,0.64,1), box-shadow 0.2s, border-color 0.2s;
    box-shadow: var(--shadow);
    display: flex; flex-direction: column; gap: 10px;
    position: relative; overflow: hidden;
  }
  .quiz-card::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px;
    background: var(--card-color, var(--accent)); border-radius: 99px 99px 0 0;
  }
  .quiz-card:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 12px 40px #1a141020;
    border-color: var(--card-color, var(--accent));
  }
  .quiz-card:active { transform: scale(0.98); }
  .card-emoji { font-size: 2rem; }
  .card-title { font-size: 1.05rem; font-weight: 800; line-height: 1.3; color: var(--ink); }
  .card-meta { font-family: 'DM Mono', monospace; font-size: 0.7rem; color: var(--muted); }
  .card-arrow {
    position: absolute; bottom: 18px; right: 18px;
    font-size: 1.2rem; opacity: 0.3;
    transition: opacity 0.2s, transform 0.2s;
  }
  .quiz-card:hover .card-arrow { opacity: 1; transform: translateX(3px); }

  .error-state {
    background: var(--card); border: 2px solid #ff6b6b40;
    border-radius: var(--radius); padding: 32px; text-align: center; color: var(--wrong);
  }
  .error-state p { margin-top: 8px; font-size: 0.9rem; color: var(--muted); font-weight: 600; }
  .error-state code { background: var(--border); padding: 2px 6px; border-radius: 6px; font-family: 'DM Mono', monospace; font-size: 0.85rem; }

  /* QUIZ SCREEN */
  .back-btn {
    display: inline-flex; align-items: center; gap: 6px;
    font-family: 'Nunito', sans-serif; font-size: 0.9rem; font-weight: 700;
    color: var(--muted); background: none; border: none; cursor: pointer;
    padding: 4px 0; margin-bottom: 24px; transition: color 0.2s;
  }
  .back-btn:hover { color: var(--accent); }

  .quiz-header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
  .quiz-title-small { font-size: 1.1rem; font-weight: 900; color: var(--ink); }
  .quiz-counter { font-family: 'DM Mono', monospace; font-size: 0.85rem; color: var(--accent); }

  .progress-bar { height: 8px; background: var(--border); border-radius: 99px; overflow: hidden; margin-bottom: 28px; }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    border-radius: 99px; transition: width 0.5s cubic-bezier(0.4,0,0.2,1);
  }

  .question-card {
    background: var(--card); border: 2px solid var(--border);
    border-radius: var(--radius); padding: 28px 24px 24px;
    box-shadow: var(--shadow); margin-bottom: 16px;
  }
  .q-type-pill {
    display: inline-block; font-family: 'DM Mono', monospace;
    font-size: 0.62rem; letter-spacing: 1.5px; text-transform: uppercase;
    padding: 4px 12px; border-radius: 99px; margin-bottom: 14px; font-weight: 500;
  }
  .q-type-pill.mcq { background: #ff6b3520; color: var(--accent); }
  .q-type-pill.truefalse { background: #4ecdc420; color: var(--accent2); }
  .q-text { font-size: 1.2rem; font-weight: 800; line-height: 1.45; color: var(--ink); }

  .options-list { display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; }
  .opt-btn {
    background: var(--card); border: 2px solid var(--border); border-radius: 14px;
    padding: 14px 18px; text-align: left; font-family: 'Nunito', sans-serif;
    font-size: 0.98rem; font-weight: 700; color: var(--ink); cursor: pointer;
    display: flex; align-items: center; gap: 14px;
    transition: border-color 0.2s, background 0.2s, transform 0.15s;
    box-shadow: 0 2px 8px #1a141008;
  }
  .opt-btn:hover:not(:disabled) { border-color: var(--accent); background: #ff6b3508; transform: translateX(4px); }
  .opt-btn:disabled { cursor: default; }
  .opt-btn.correct { border-color: var(--correct); background: #2ec4b615; }
  .opt-btn.wrong   { border-color: var(--wrong);   background: #ff6b6b15; }
  .opt-letter {
    font-family: 'DM Mono', monospace; font-size: 0.75rem;
    width: 26px; height: 26px; border-radius: 8px; background: var(--bg);
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0; color: var(--muted); font-weight: 500;
    transition: background 0.2s, color 0.2s;
  }
  .opt-btn.correct .opt-letter { background: var(--correct); color: white; }
  .opt-btn.wrong   .opt-letter { background: var(--wrong);   color: white; }

  .feedback-bubble {
    border-radius: 14px; padding: 14px 18px;
    font-size: 0.95rem; font-weight: 800;
    display: none; align-items: center; gap: 10px; margin-bottom: 16px;
  }
  .feedback-bubble.show { display: flex; animation: popIn 0.3s cubic-bezier(0.34,1.56,0.64,1); }
  .feedback-bubble.correct { background: #2ec4b618; color: var(--correct); }
  .feedback-bubble.wrong   { background: #ff6b6b18; color: var(--wrong); }

  .next-row { display: flex; justify-content: flex-end; }
  .btn {
    font-family: 'Nunito', sans-serif; font-weight: 800; font-size: 1rem;
    padding: 12px 28px; border: none; border-radius: 14px; cursor: pointer;
    transition: transform 0.15s, opacity 0.15s;
  }
  .btn:active { transform: scale(0.96); }
  .btn-accent { background: var(--accent); color: white; }
  .btn-accent:hover { opacity: 0.88; }
  .btn-outline { background: var(--card); border: 2px solid var(--border); color: var(--ink); }
  .btn-outline:hover { border-color: var(--accent); color: var(--accent); }

  /* RESULT */
  .result-hero {
    background: var(--card); border: 2px solid var(--border);
    border-radius: var(--radius); padding: 40px 24px 32px;
    text-align: center; box-shadow: var(--shadow); margin-bottom: 24px;
  }
  .score-ring { width: 150px; height: 150px; position: relative; margin: 0 auto 20px; }
  .score-ring svg { transform: rotate(-90deg); }
  .score-ring circle { fill: none; stroke-width: 10; stroke-linecap: round; }
  .ring-bg { stroke: var(--border); }
  .ring-fill { stroke: var(--accent); transition: stroke-dashoffset 1.2s cubic-bezier(0.4,0,0.2,1); }
  .score-inner { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
  .score-pct { font-size: 2.2rem; font-weight: 900; color: var(--ink); }
  .score-sub { font-family: 'DM Mono', monospace; font-size: 0.7rem; color: var(--muted); }
  .result-emoji { font-size: 2.5rem; margin-bottom: 8px; }
  .result-title { font-size: 1.7rem; font-weight: 900; margin-bottom: 6px; }
  .result-meta { color: var(--muted); font-size: 0.9rem; font-weight: 600; }
  .result-actions { display: flex; gap: 12px; justify-content: center; margin-top: 24px; flex-wrap: wrap; }

  .review-section { margin-top: 8px; }
  .review-title { font-size: 1rem; font-weight: 900; margin-bottom: 14px; color: var(--ink); }
  .review-item {
    background: var(--card); border: 2px solid var(--border); border-radius: 14px;
    padding: 16px 18px; margin-bottom: 10px; border-left: 4px solid var(--border);
  }
  .review-item.ok  { border-left-color: var(--correct); }
  .review-item.bad { border-left-color: var(--wrong); }
  .review-q { font-size: 0.95rem; font-weight: 800; margin-bottom: 6px; }
  .review-ans { font-family: 'DM Mono', monospace; font-size: 0.75rem; line-height: 1.8; color: var(--muted); }
  .review-ans .c { color: var(--correct); font-weight: 500; }
  .review-ans .w { color: var(--wrong); font-weight: 500; }
</style>
</head>
<body>
<main>

  <div class="site-header">
    <span class="header-emoji">üéì</span>
    <div class="site-title">Ismail's <span class="name">Quizzes</span></div>
    <div class="site-subtitle">Pick a topic and test your knowledge!</div>
  </div>

  <!-- HOME -->
  <section class="screen active" id="screen-home">
    <div id="quiz-list-container">
      <div class="loading-state"><div class="spinner"></div>Loading quizzes‚Ä¶</div>
    </div>
  </section>

  <!-- QUIZ -->
  <section class="screen" id="screen-quiz">
    <button class="back-btn" onclick="backToHome()">‚Üê All Quizzes</button>
    <div class="quiz-header-row">
      <div class="quiz-title-small" id="active-quiz-title"></div>
      <div class="quiz-counter" id="q-counter">1 / 10</div>
    </div>
    <div class="progress-bar"><div class="progress-fill" id="progress-fill" style="width:0%"></div></div>
    <div class="question-card">
      <div class="q-type-pill mcq" id="q-type-pill">MCQ</div>
      <div class="q-text" id="q-text"></div>
    </div>
    <div class="options-list" id="options-list"></div>
    <div class="feedback-bubble" id="feedback-bubble"></div>
    <div class="next-row">
      <button class="btn btn-accent" id="next-btn" style="display:none" onclick="nextQuestion()">Next ‚Üí</button>
    </div>
  </section>

  <!-- RESULT -->
  <section class="screen" id="screen-result">
    <button class="back-btn" onclick="backToHome()">‚Üê All Quizzes</button>
    <div class="result-hero">
      <div class="score-ring">
        <svg viewBox="0 0 100 100" width="150" height="150">
          <circle class="ring-bg" cx="50" cy="50" r="42"/>
          <circle class="ring-fill" id="ring-fill" cx="50" cy="50" r="42"
            stroke-dasharray="263.9" stroke-dashoffset="263.9"/>
        </svg>
        <div class="score-inner">
          <div class="score-pct" id="res-pct">0%</div>
          <div class="score-sub" id="res-frac">0/0</div>
        </div>
      </div>
      <div class="result-emoji" id="res-emoji">üéâ</div>
      <div class="result-title" id="res-title">Quiz Complete!</div>
      <div class="result-meta" id="res-meta"></div>
      <div class="result-actions">
        <button class="btn btn-accent" onclick="retryQuiz()">Try Again ‚Ü∫</button>
        <button class="btn btn-outline" onclick="backToHome()">All Quizzes</button>
      </div>
    </div>
    <div class="review-section">
      <div class="review-title">üìù Review your answers</div>
      <div id="review-list"></div>
    </div>
  </section>

</main>
<script>
// ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// This path works if manifest.json is in the same
// folder as index.html in your GitHub repo.
const MANIFEST_URL = './manifest.json';
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const CARD_COLORS = ['#ff6b35','#4ecdc4','#f7b731','#a855f7','#ec4899','#22c55e','#3b82f6','#ef4444'];

let allQuizzes = [];
let activeQuiz = null;
let questions  = [];
let current    = 0;
let score      = 0;
let answers    = [];

// BOOT
async function boot() {
  try {
    const res = await fetch(MANIFEST_URL + '?_=' + Date.now());
    if (!res.ok) throw new Error();
    allQuizzes = await res.json();
    renderHome();
  } catch {
    document.getElementById('quiz-list-container').innerHTML = `
      <div class="error-state">
        ‚ö†Ô∏è Couldn't load quizzes
        <p>Make sure <code>manifest.json</code> is in the same folder as <code>index.html</code>.</p>
      </div>`;
  }
}

// HOME
function renderHome() {
  const container = document.getElementById('quiz-list-container');
  if (!allQuizzes.length) {
    container.innerHTML = `<div class="error-state">No quizzes in manifest.json yet!<p>Add your first quiz entry to get started.</p></div>`;
    return;
  }
  container.innerHTML = `<div class="section-label">Choose a quiz ‚Äî ${allQuizzes.length} available</div><div class="quiz-grid" id="quiz-grid"></div>`;
  const grid = document.getElementById('quiz-grid');
  allQuizzes.forEach((quiz, i) => {
    const color = CARD_COLORS[i % CARD_COLORS.length];
    const card = document.createElement('div');
    card.className = 'quiz-card';
    card.style.setProperty('--card-color', color);
    card.innerHTML = `
      <div class="card-emoji">${quiz.emoji || 'üìö'}</div>
      <div class="card-title">${quiz.name}</div>
      <div class="card-meta">${quiz.description || 'Tap to start'}</div>
      <div class="card-arrow">‚Üí</div>`;
    card.onclick = () => launchQuiz(quiz);
    grid.appendChild(card);
  });
}

// LAUNCH
async function launchQuiz(quiz) {
  activeQuiz = quiz;
  try {
    const res = await fetch(quiz.csvUrl + '?_=' + Date.now());
    if (!res.ok) throw new Error();
    const text = await res.text();
    questions = parseCSV(text);
    if (!questions.length) throw new Error('empty');
    shuffle(questions);
    current = 0; score = 0; answers = [];
    document.getElementById('active-quiz-title').textContent = quiz.name;
    showScreen('screen-quiz');
    renderQuestion();
  } catch {
    alert('Could not load "' + quiz.name + '". Check the csvUrl in manifest.json.');
  }
}

// CSV
function parseCSV(text) {
  const lines = text.trim().split('\n').filter(l => l.trim());
  return lines.slice(1).map(line => {
    const cols = splitCSVLine(line);
    const [question, a, b, c, d, answer, type] = cols.map(s => s.trim());
    const t = (type || '').toLowerCase().replace(/[^a-z]/g, '');
    const opts = t === 'truefalse' ? [a, b].filter(Boolean) : [a, b, c, d].filter(Boolean);
    return { question, opts, answer: (answer || 'A').toUpperCase(), type: t || 'mcq' };
  }).filter(q => q.question && q.opts.length);
}

function splitCSVLine(line) {
  const result = []; let inQ = false, cur = '';
  for (const ch of line) {
    if (ch === '"') { inQ = !inQ; continue; }
    if (ch === ',' && !inQ) { result.push(cur); cur = ''; continue; }
    cur += ch;
  }
  result.push(cur);
  return result;
}

// QUIZ
function renderQuestion() {
  const q = questions[current];
  const total = questions.length;
  const letters = ['A','B','C','D'];

  document.getElementById('q-counter').textContent = `${current+1} / ${total}`;
  document.getElementById('progress-fill').style.width = `${(current / total) * 100}%`;

  const pill = document.getElementById('q-type-pill');
  pill.textContent = q.type === 'truefalse' ? 'True / False' : 'MCQ';
  pill.className = 'q-type-pill ' + (q.type === 'truefalse' ? 'truefalse' : 'mcq');
  document.getElementById('q-text').textContent = q.question;

  const list = document.getElementById('options-list');
  list.innerHTML = '';
  q.opts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'opt-btn';
    btn.innerHTML = `<span class="opt-letter">${letters[i]}</span>${opt}`;
    btn.onclick = () => selectAnswer(letters[i], btn, q);
    list.appendChild(btn);
  });

  document.getElementById('feedback-bubble').className = 'feedback-bubble';
  document.getElementById('next-btn').style.display = 'none';
}

function selectAnswer(letter, clickedBtn, q) {
  document.querySelectorAll('.opt-btn').forEach(b => b.disabled = true);
  const letters = ['A','B','C','D'];
  const correctIdx = letters.indexOf(q.answer);
  const isCorrect  = letter === q.answer;

  if (isCorrect) { clickedBtn.classList.add('correct'); score++; }
  else {
    clickedBtn.classList.add('wrong');
    document.querySelectorAll('.opt-btn')[correctIdx]?.classList.add('correct');
  }

  const fb = document.getElementById('feedback-bubble');
  fb.className = 'feedback-bubble show ' + (isCorrect ? 'correct' : 'wrong');
  fb.textContent = isCorrect ? '‚úì Correct! Great job!' : `‚úó The answer is ${q.answer}: ${q.opts[correctIdx]}`;

  answers.push({ question: q.question, chosen: `${letter}: ${q.opts[letters.indexOf(letter)]}`, correct: `${q.answer}: ${q.opts[correctIdx]}`, isCorrect });

  const nb = document.getElementById('next-btn');
  nb.style.display = 'inline-block';
  nb.textContent = current === questions.length - 1 ? 'See Results üèÅ' : 'Next ‚Üí';
}

function nextQuestion() {
  current++;
  if (current < questions.length) renderQuestion(); else showResults();
}

// RESULTS
function showResults() {
  showScreen('screen-result');
  const pct = Math.round((score / questions.length) * 100);
  document.getElementById('res-pct').textContent = pct + '%';
  document.getElementById('res-frac').textContent = `${score} / ${questions.length}`;
  document.getElementById('res-emoji').textContent = pct === 100 ? 'üèÜ' : pct >= 80 ? 'üåü' : pct >= 60 ? 'üëç' : pct >= 40 ? 'üí™' : 'üìö';
  document.getElementById('res-title').textContent = pct === 100 ? 'Perfect Score!' : pct >= 80 ? 'Excellent Work!' : pct >= 60 ? 'Good Job!' : pct >= 40 ? 'Keep Practising!' : 'Study More!';
  document.getElementById('res-meta').textContent = `${questions.length} questions ¬∑ ${score} correct ¬∑ ${questions.length - score} wrong`;

  setTimeout(() => {
    document.getElementById('ring-fill').style.strokeDashoffset = 263.9 - (pct / 100) * 263.9;
  }, 100);

  const list = document.getElementById('review-list');
  list.innerHTML = '';
  answers.forEach(a => {
    const div = document.createElement('div');
    div.className = 'review-item ' + (a.isCorrect ? 'ok' : 'bad');
    div.innerHTML = `<div class="review-q">${a.question}</div>
      <div class="review-ans">${a.isCorrect
        ? `<span class="c">‚úì ${a.chosen}</span>`
        : `<span class="w">‚úó Your answer: ${a.chosen}</span><br><span class="c">‚úì Correct: ${a.correct}</span>`}</div>`;
    list.appendChild(div);
  });
}

function retryQuiz() {
  shuffle(questions); current = 0; score = 0; answers = [];
  showScreen('screen-quiz'); renderQuestion();
}

function backToHome() { showScreen('screen-home'); }

function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.scrollTo(0, 0);
}

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

boot();
</script>
</body>
</html>
